<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Password hash cracking | Lukas Scheucher</title><meta name=viewport content="width=device-width,minimum-scale=1"><meta name=description content="Table Of Contents Motivation How does one log in on a website? A quick intro to hash-functions Let&rsquo;s design a trivial hash function How hashes are used to identify yourself online Brute-forcing password hashes Complexity considerations A naive approach A statistically determined approach A concrete example Password attack using dictionaries Password Hash Cracking Motivation I recently had an unauthorized access on my Amazon account. Luckily, Amazon sent me a 2-factor authentification request to confirm my login, which I promptly denied, but it got me interested in how these kind of attacks work."><meta name=generator content="Hugo 0.101.0"><meta name=robots content="noindex, nofollow"><link rel=stylesheet href=/ananke/css/main.min.css><meta property="og:title" content="Password hash cracking"><meta property="og:description" content="Table Of Contents Motivation How does one log in on a website? A quick intro to hash-functions Let&rsquo;s design a trivial hash function How hashes are used to identify yourself online Brute-forcing password hashes Complexity considerations A naive approach A statistically determined approach A concrete example Password attack using dictionaries Password Hash Cracking Motivation I recently had an unauthorized access on my Amazon account. Luckily, Amazon sent me a 2-factor authentification request to confirm my login, which I promptly denied, but it got me interested in how these kind of attacks work."><meta property="og:type" content="article"><meta property="og:url" content="https://scheuclu.github.io/posts/password_hash_cracking/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-27T15:01:17+02:00"><meta property="article:modified_time" content="2022-07-27T15:01:17+02:00"><meta itemprop=name content="Password hash cracking"><meta itemprop=description content="Table Of Contents Motivation How does one log in on a website? A quick intro to hash-functions Let&rsquo;s design a trivial hash function How hashes are used to identify yourself online Brute-forcing password hashes Complexity considerations A naive approach A statistically determined approach A concrete example Password attack using dictionaries Password Hash Cracking Motivation I recently had an unauthorized access on my Amazon account. Luckily, Amazon sent me a 2-factor authentification request to confirm my login, which I promptly denied, but it got me interested in how these kind of attacks work."><meta itemprop=datePublished content="2022-07-27T15:01:17+02:00"><meta itemprop=dateModified content="2022-07-27T15:01:17+02:00"><meta itemprop=wordCount content="1749"><meta itemprop=keywords content="cryptography,hashing,Python,"><meta name=twitter:card content="summary"><meta name=twitter:title content="Password hash cracking"><meta name=twitter:description content="Table Of Contents Motivation How does one log in on a website? A quick intro to hash-functions Let&rsquo;s design a trivial hash function How hashes are used to identify yourself online Brute-forcing password hashes Complexity considerations A naive approach A statistically determined approach A concrete example Password attack using dictionaries Password Hash Cracking Motivation I recently had an unauthorized access on my Amazon account. Luckily, Amazon sent me a 2-factor authentification request to confirm my login, which I promptly denied, but it got me interested in how these kind of attacks work."></head><body class="ma0 avenir bg-near-white"><header class="cover bg-top" style=background-image:url(https://scheuclu.github.io/images/numbers.png)><div class=bg-black-60><nav class="pv3 ph3 ph4-ns" role=navigation><div class="flex-l justify-between items-center center"><a href=/ class="f3 fw2 hover-white no-underline white-90 dib"><img src=/images/logo_white_small.png class="w100 mw5-ns" alt="Lukas Scheucher"></a><div class="flex-l items-center"><ul class="pl0 mr3"><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/tags/ title="Tags page">Tags</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/contact/ title="Contact page">Contact</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/cv/ title="CV page">CV</a></li><li class="list f5 f4-ns fw4 dib pr3"><a class="hover-white no-underline white-90" href=/posts/ title="Posts page">Posts</a></li></ul><div class=ananke-socials><a href=https://github.com/scheuclu target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href target=_blank class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://www.youtube.com/channel/UC0So4gJ11qUZI_dzqVMOq8w target=_blank class="youtube ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="YouTube link" rel=noopener aria-label="follow on YouTube——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M42.527 41.34c-.278.0-.478.078-.6.244-.121.156-.18.424-.18.796v.896h1.543V42.38c0-.372-.062-.64-.185-.796C42.989 41.418 42.792 41.34 42.527 41.34zM36.509 41.309c.234.0.417.076.544.23.123.155.185.383.185.682v4.584c0 .286-.053.487-.153.611-.1.127-.256.189-.47.189-.148.0-.287-.033-.421-.096-.135-.062-.274-.171-.415-.313v-5.531c.119-.122.239-.213.36-.271C36.26 41.335 36.383 41.309 36.509 41.309zm5.239 3.349v1.672c0 .468.057.792.17.974.118.181.313.269.592.269.289.0.491-.076.606-.229.114-.153.175-.489.175-1.013v-.405h1.795v.456c0 .911-.217 1.596-.657 2.059-.435.459-1.089.687-1.958.687-.781.0-1.398-.242-1.847-.731-.448-.486-.676-1.157-.676-2.014v-3.986c0-.768.249-1.398.742-1.882.493-.484 1.128-.727 1.911-.727.799.0 1.413.225 1.843.674.429.448.642 1.093.642 1.935v2.264H41.748zm-3.125 3.837c-.271.336-.669.501-1.187.501-.343.0-.646-.062-.912-.192-.267-.129-.519-.327-.746-.601v.681h-1.764V36.852h1.764v3.875c.237-.27.485-.478.748-.616.267-.143.534-.212.805-.212.554.0.975.189 1.265.565.294.379.438.933.438 1.66v4.926C39.034 47.678 38.897 48.159 38.623 48.495zM30.958 48.884v-.976c-.325.361-.658.636-1.009.822-.349.191-.686.282-1.014.282-.405.0-.705-.129-.913-.396-.201-.266-.305-.658-.305-1.189v-7.422h1.744v6.809c0 .211.037.362.107.457.077.095.196.141.358.141.128.0.292-.062.488-.188.197-.125.375-.283.542-.475v-6.744H32.7v8.878H30.958zM24.916 38.6v10.284h-1.968V38.6h-2.034v-1.748h6.036V38.6H24.916zm8.078-5.622c0-.001 12.08.018 13.514 1.45 1.439 1.435 1.455 8.514 1.455 8.555.0.0-.012 7.117-1.455 8.556C45.074 52.969 32.994 53 32.994 53s-12.079-.031-13.516-1.462c-1.438-1.435-1.441-8.502-1.441-8.556.0-.041.004-7.12 1.441-8.555 1.438-1.431 13.516-1.45 13.516-1.449zm9.526-3.723h-1.966v-1.08c-.358.397-.736.703-1.13.909-.392.208-.771.312-1.14.312-.458.0-.797-.146-1.027-.437-.229-.291-.345-.727-.345-1.311v-8.172h1.962v7.497c0 .231.045.399.127.502.08.104.216.156.399.156.143.0.327-.069.548-.206.22-.137.423-.312.605-.527v-7.422h1.966V29.255zM31.847 27.588c.139.147.339.219.6.219.266.0.476-.075.634-.223.157-.152.235-.358.235-.618v-5.327c0-.214-.08-.387-.241-.519-.16-.131-.37-.196-.628-.196-.241.0-.435.065-.586.196-.148.132-.225.305-.225.519v5.327C31.636 27.233 31.708 27.439 31.847 27.588zm-1.439-7.685c.528-.449 1.241-.674 2.132-.674.812.0 1.48.237 2.001.711.517.473.777 1.083.777 1.828v5.051c0 .836-.255 1.491-.762 1.968-.513.476-1.212.714-2.106.714-.858.0-1.547-.246-2.064-.736-.513-.492-.772-1.152-.772-1.983v-5.068C29.613 20.954 29.877 20.351 30.408 19.903zM24.262 16h-2.229l2.634 8.003v5.252h2.213v-5.5L29.454 16h-2.25l-1.366 5.298h-.139L24.262 16zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></nav><div class="tc-l pv6 ph3 ph4-ns"><h1 class="f2 f1-l fw2 white-90 mb0 lh-title">Password hash cracking</h1></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-FL0RFP3MP3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-FL0RFP3MP3",{anonymize_ip:!1})}</script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-FL0RFP3MP3","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script></header><script src=https://cdn.plot.ly/plotly-latest.min.js></script>
<link rel=stylesheet href=/css/table.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css><script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script><main class=pb7 role=main><article class="flex-l flex-wrap justify-between mw8 center ph3"><header class="mt4 w-100"><aside class="instapaper_ignoref b helvetica tracked">POSTS</aside><div id=sharing class="mt3 ananke-socials"><a href="https://www.linkedin.com/shareArticle?mini=true&url=https://scheuclu.github.io/posts/password_hash_cracking/&title=Password%20hash%20cracking" class="ananke-social-link linkedin no-underline" aria-label="share on LinkedIn"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div><h1 class="f1 athelas mt3 mb1">Password hash cracking</h1><time class="f6 mv4 dib tracked" datetime=2022-07-27T15:01:17+02:00>July 27, 2022</time></header><div class="nested-copy-line-height lh-copy serif f4 nested-links mid-gray pr4-l w-two-thirds-l"><script type=text/javascript src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><div><h2>Table Of Contents</h2><nav id=TableOfContents><ul><li><a href=#motivation>Motivation</a></li><li><a href=#how-does-one-log-in-on-a-website>How does one log in on a website?</a><ul><li><a href=#a-quick-intro-to-hash-functions>A quick intro to hash-functions</a></li><li><a href=#lets-design-a-trivial-hash-function>Let&rsquo;s design a trivial hash function</a></li><li><a href=#how-hashes-are-used-to-identify-yourself-online>How hashes are used to identify yourself online</a></li></ul></li><li><a href=#brute-forcing-password-hashes>Brute-forcing password hashes</a></li><li><a href=#complexity-considerations>Complexity considerations</a><ul><li><a href=#a-naive-approach>A naive approach</a></li><li><a href=#a-statistically-determined-approach>A statistically determined approach</a></li></ul></li><li><a href=#a-concrete-example>A concrete example</a></li><li><a href=#password-attack-using-dictionaries>Password attack using dictionaries</a></li></ul></nav></div><h1 id=password-hash-cracking>Password Hash Cracking</h1><hr><h2 id=motivation>Motivation</h2><p>I recently had an unauthorized access on my Amazon account. Luckily, Amazon sent me a 2-factor authentification request to confirm my login, which I promptly denied, but it got me interested in how these kind of attacks work.
Now, I have been using a password manager for years (<a href=https://bitwarden.com/>Bitwarden</a>), but my Amazon account predates it and I guess, I was too lazy to change the password.</p><p>So, out of curiosity, I started investigating how these kinds of attacks work.</p><hr><h2 id=how-does-one-log-in-on-a-website>How does one log in on a website?</h2><p>In essence, a website has a database with all valid logins. When you enter your username and password, you provide one on these valid logins.<br>However, these databases do not actually store your passwords. This would be incredibly unsafe for, if the website gets compromised and the database leaked, everyone would now know your password, which is probably being used on other pages too.</p><p>Instead, your username is stored alongside the hashvalue of your password. If a leak occurs, only the hash is published. An attacker would still not know which password led to that hash.</p><h3 id=a-quick-intro-to-hash-functions>A quick intro to hash-functions</h3><p>The fundamental technology behind safe logins to websites are hash-functions. A hash function has a few characteristics:</p><ul><li><strong>arbitrary length input</strong></li><li><strong>non-injective, non-surjective:</strong> Each input maps to a specific output. Different inputs may map to the same output. There may be points in the output space that have no corresponding input.</li><li><strong>no correlation between inputs and outputs:</strong> Given two points $x_1$ and $x_2$ in the input space which map to $y_1$ and $y_2$ in the output space, there should be no correlation between $||x_2-y_1||$ and $||y_2-y_1||$. In lay-mans terms, this means that if two points in the input space are simiar, if you run them through the hash funciton, they should give very diffrent outputs.</li><li><strong>uniform output distribution:</strong> All points in the output space should be approximately equally likely. This is another way of saying there should be as little collisions as possible.</li></ul><h3 id=lets-design-a-trivial-hash-function>Let&rsquo;s design a trivial hash function</h3><p>We are searching for a hash function that maps a number $N \in [0 &mldr; 2^8]$ to a hash $h(N) \in [0 &mldr; 2^8]$.</p><p>Naively, we can simply reverse the binary representation.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>naive_hash</span>(n):
</span></span><span style=display:flex><span>  b<span style=color:#f92672>=</span>bin(n)
</span></span><span style=display:flex><span>  b<span style=color:#f92672>=</span>b[<span style=color:#ae81ff>2</span>:]<span style=color:#f92672>.</span>rjust(<span style=color:#ae81ff>8</span>, <span style=color:#e6db74>&#39;0&#39;</span>)
</span></span><span style=display:flex><span>  h<span style=color:#f92672>=</span>int(b[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>::<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>],<span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> h
</span></span></code></pre></div><p>Now, we can take any arbirary <code>ASCII</code> string and compute it&rsquo;s hash by summing up the hashes of it&rsquo;s binary representations modulo <code>2^8</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Python data-lang=Python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>dummy_hash_password</span>(s):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> sum([dummy_hash(ord(i)) <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> s]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>2</span><span style=color:#f92672>**</span><span style=color:#ae81ff>8</span>
</span></span></code></pre></div><table><thead><tr><th style=text-align:left>Password</th><th style=text-align:left>hash</th></tr></thead><tbody><tr><td style=text-align:left>code</td><td style=text-align:left>136</td></tr><tr><td style=text-align:left>code1</td><td style=text-align:left>20</td></tr><tr><td style=text-align:left>code1!</td><td style=text-align:left>152</td></tr></tbody></table><p>At first glance, this looks like a good random hash:<div id=/plots/input_to_output.json class=plotly style=height:400px></div><script>Plotly.d3.json("/plots/input_to_output.json",function(e,t){Plotly.plot("/plots/input_to_output.json",t.data,t.layout,{responsive:!0})})</script></p><p>But there are still hidden patterns in the outputs as shown here:<div id=/plots/pattern.json class=plotly style=height:400px></div><script>Plotly.d3.json("/plots/pattern.json",function(e,t){Plotly.plot("/plots/pattern.json",t.data,t.layout,{responsive:!0})})</script></p><p>In practice, designing good hash funcitons in incredible difficult and still an active area of reasearch. Modern hash function are a complicated interwoven set of operations.</p><p>Also:</p><table><thead><tr><th style=text-align:left>Password</th><th style=text-align:right>hash</th></tr></thead><tbody><tr><td style=text-align:left>code</td><td style=text-align:right>136</td></tr><tr><td style=text-align:left>Code</td><td style=text-align:right>132</td></tr><tr><td style=text-align:left>bear</td><td style=text-align:right>192</td></tr><tr><td style=text-align:left>Bear</td><td style=text-align:right>188</td></tr><tr><td style=text-align:left>water</td><td style=text-align:right>150</td></tr><tr><td style=text-align:left>Water</td><td style=text-align:right>146</td></tr></tbody></table><p>I hope you see the pattern. Even if we extended this hash function to a greater bit length, it would be incredibly unsafe.</p><p>What we have created above is an <em>8-bit hash function</em>, meaning that it&rsquo;s output space is 8-bits. The hashes are therefor numbers in the range of <code>[0 ... 255]</code>.</p><p>Modern hash functions are much larger than that. E.g. <a href=https://en.wikipedia.org/wiki/SHA-2>SHA256</a> uses 256 bit, meaning that there are a total of <code>2^56</code>(<code>1.1579209e+77</code>) different outputs.
For comparison, the number of sand grains on earth is estimated at <code>7.5e18</code> grains and the number of atoms on earth at <code>1.33e50</code>.
So, if you created a new planet earth for every sand grain on earh, you would need <code>9.8e68</code> atoms, which is still a billion times less than there are outpout possibilities in <code>SHA-256</code>.</p><h3 id=how-hashes-are-used-to-identify-yourself-online>How hashes are used to identify yourself online</h3><p>When you login online, you typically provide a <code>username</code> and a <code>password</code>.
The server then checks whether this particular combination is known.
A bad practice, which is still encountered sometimes, would be for the server to simply store a table of <code>username</code>-<code>password</code> combinations.
However, there is always the possibility for a server to be compromised and the table to be leaked on the internet.
So, instead, websites typically store your username along with the hash of your password. When you log in, the server quickly computes the hash of the password you provided and compares it against the one it has stored.</p><p>If the table ever gets leaked, an attacker now has you password hash. But in order to get access to your account, he then needs to find a password that produces this exact hash. Typically this is done via brute-force attack.</p><hr><h2 id=brute-forcing-password-hashes>Brute-forcing password hashes</h2><p>As discussed about, servers sometimes get compromised and login data is leaked. I guess this is what happened to me,
An attacker now has a username and a password hash. Let&rsquo;s assume the hash is in <code>SHA1</code> format.</p><p>Now, in a brute-force attack, an attacker simply tries to guess the password by trying all possible combinations of inputs until they find one that creates the leaked hash. If he finds one, the hacker can then log into the site using this input as password. Due to collissions, this might not even be the same password you&rsquo;ve been using, although it is highly likely.</p><hr><h2 id=complexity-considerations>Complexity considerations</h2><p>Brute forcing the password from a hash seems straight forward. In reality however, this task very quickly becomes computationally infeasible, unless one is willing to spend an excuberant amount of computational resources.</p><p>Let&rsquo;s look at some examples:</p><h3 id=a-naive-approach>A naive approach</h3><p>To get an idea of how complex it is to recover the password from a hash, let&rsquo;s make a few assumptions:</p><ol><li>Our hash is <a href=https://en.wikipedia.org/wiki/SHA-1>SHA-1</a>. This is a 128 bit hash.</li><li>The password only consists of upper and lower case letter as well as digits. This means we have an alphabet of <code>26*2+10=62</code> characters.</li><li>We use an RTX-3090 on vast.ai to recover hashes. It has a SHA-1 hashrate of 22757.6 MH/s.</li><li>We use the cheapest cloud provider I was able to find, at 0.31$ an hour for the RTX-3090.</li></ol><p>this gives the following table:</p><table><thead><tr><th>password length</th><th># password options</th><th>time to bruteforce [min]</th><th>cost<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></th></tr></thead><tbody><tr><td>1</td><td>62</td><td>2 ns</td><td>free</td></tr><tr><td>2</td><td>3.8e3</td><td>16 us</td><td>free</td></tr><tr><td>3</td><td>2.3e5</td><td>104 ms</td><td>free</td></tr><tr><td>4</td><td>1.4e7</td><td>6 ms</td><td>free</td></tr><tr><td>5</td><td>9.1e8</td><td>40 ms</td><td>free</td></tr><tr><td>6</td><td>5.6e10</td><td>2.5 s</td><td>free</td></tr><tr><td>7</td><td>3.5e12</td><td>2.5 min</td><td>1ct</td></tr><tr><td>8</td><td>2.1e14</td><td>2.6 h</td><td>82 ct</td></tr><tr><td>9</td><td>1.3e16</td><td>6.9 d</td><td>51 $</td></tr></tbody></table><p>Now, most of us have experienced that websites require us to use special symbols. Let&rsquo;s just consider the 5 most used ones: <code>["_", ".", "-", "!", "@", "*", "$", "?", "&", "%"]</code>. We now have <code>72</code> different characters in our alpahabet.</p><p>This simple addition changes the table as follows:</p><table><thead><tr><th>password length</th><th># password options</th><th>time to bruteforce [min]</th><th>cost<sup id=fnref1:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></th></tr></thead><tbody><tr><td>1</td><td>62</td><td>4 ns</td><td>free</td></tr><tr><td>2</td><td>3.8e3</td><td>23 us</td><td>free</td></tr><tr><td>3</td><td>2.3e5</td><td>164 uss</td><td>free</td></tr><tr><td>4</td><td>1.4e7</td><td>11 ms</td><td>free</td></tr><tr><td>5</td><td>9.1e8</td><td>850 ms</td><td>free</td></tr><tr><td>6</td><td>5.6e10</td><td>6 s</td><td>free</td></tr><tr><td>7</td><td>3.5e12</td><td>7.3 min</td><td>4 ct</td></tr><tr><td>8</td><td>2.1e14</td><td>9 h</td><td>3 $</td></tr><tr><td>9</td><td>1.3e16</td><td>26 d</td><td>200 $</td></tr></tbody></table><h3 id=a-statistically-determined-approach>A statistically determined approach</h3><p>As you can see, it very quicly becomes infeasible to crack this hash with increasing password length.</p><p>However, we can take advantage of human psychology. Here&rsquo;s some of the most commonly used observations</p><ol><li>People often use capital letters at the beginning.</li><li>Special characters are most likely used at the very end.</li><li>Different characters have different likelihood. E.g. The most commonly used letter is <code>e</code> and the most commonly used special character is <code>-</code>.</li><li>Passwords are often variations of actual words/names. E.g. <code>Jacob -> J4c0b!</code>. By using a dictionary and performing most common manipulations, we can quickly test for all of the variations.</li></ol><p>While taking likelihoods into account does not change the total search space, it drastically reduces the average time until the password is found.</p><p>Let&rsquo;s have a look at the numbers with just 2 simple modifcations to the last table:</p><ol><li>We assume that only the first symbol is a captial letter</li><li>We assume that the last symbol is a special character of number.</li></ol><p>This results in the following table:</p><table><thead><tr><th>password length</th><th># password options</th><th>time to bruteforce [min]</th><th>cost<sup id=fnref2:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></th></tr></thead><tbody><tr><td>4</td><td>1213056</td><td>90 us</td><td>free</td></tr><tr><td>5</td><td>43670016</td><td>320 us</td><td>free</td></tr><tr><td>6</td><td>1572120576</td><td>1 ms</td><td>free</td></tr><tr><td>7</td><td>56596340736</td><td>40 ms</td><td>free</td></tr><tr><td>8</td><td>2037468266496</td><td>1.5 s</td><td>free</td></tr><tr><td>9</td><td>73348857593856</td><td>54 s</td><td>28 ct</td></tr></tbody></table><p>As you can see, the cost is drastically reduced, while we will still recover a vast majoriy of passwords using these assumptions.</p><h2 id=a-concrete-example>A concrete example</h2><p>With all of the above considerations in mind, let&rsquo;s have a look at some arbirarly though-up passwords:</p><table><thead><tr><th>password</th><th>SHA1 hash</th></tr></thead><tbody><tr><td>tabletop</td><td>dd702c884ce8179f443aca343d61175408396b4f</td></tr><tr><td>!Energy!</td><td>dd8a0212c9a8950ac116962cf2bf3b6746e95a79</td></tr><tr><td>21EXg4vI</td><td>7a0fd2b60e88468a60db9d8812b0cfa2d1f25700</td></tr></tbody></table><p>We use hashcat on a RTX-3090 to try and attach these hashes.<br>As discuassed above, a pure bruteforce approach with all possible characters, quickly becomes infeasible.
An attacker will most likely try the simplest appraoches first, and then successively try more expensive configs, until success is achieved.
Pretending not to know the cleartext passwords, we will try the following modes:</p><table><thead><tr><th>attack mode</th><th>descrition</th><th># combos</th><th>worst case runtime</th><th>worst case cost</th></tr></thead><tbody><tr><td>1</td><td>combination of lower-case letters</td><td>2.1e11</td><td>9s</td><td>free</td></tr><tr><td>2</td><td>upper-, lower-case, numbers and 10 symbols</td><td>7.2e14</td><td>9h</td><td>TODO</td></tr><tr><td>3</td><td>dictinary attack with simple modifications</td><td>TODO</td><td>TODO</td><td>TODO</td></tr></tbody></table><p>Using these attach modes one after the other, I was able to crackt the passwords in the following timespans:</p><table><thead><tr><th>password</th><th>time to crack</th><th>cost</th></tr></thead><tbody><tr><td>tabletop</td><td>2 min</td><td>free</td></tr><tr><td>!Energy!</td><td>26 h</td><td>8 $</td></tr><tr><td>21EXg4vI</td><td>3 h</td><td>1 $</td></tr></tbody></table><p>What is more, the problem can be perfectly parallelized in multiple GPUs, thus almost bringing down the solution time arbitrarily, without a significant increase in overall cost.</p><h2 id=password-attack-using-dictionaries>Password attack using dictionaries</h2><p>It has been shown that, non-tech savy users in particular, use password derived from real words. This could be names, cities or something similar which is then slightly modified to adhere to modern website password standards. E.g. &ldquo;Beverly&rdquo; could become &ldquo;1Beverly!&rdquo;, &ldquo;B3v3rly&rdquo;, or &ldquo;?Beverly1!&rdquo;.
If the password follows this patterns, than cracking using dictionaries plus modifications can be extremly effective.</p><p>From our 3 example passwords above, 2 should be crackable like that. let&rsquo;s give it a try!<br>First, we need to find a dictionary to use.</p><p><strong>[TBD]</strong></p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Based on a RTX-3090 instance on <a href=https://vast.ai>vast.ai</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref1:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a>&#160;<a href=#fnref2:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div><div class="mt6 instapaper_ignoref"><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//lukasscheucher.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><aside class="w-30-l mt6-l"><div class="bg-light-gray pa3 nested-list-reset nested-copy-line-height nested-links"><p class="f5 b mb3">Related</p><ul class="pa0 list"><li class=mb2><a href=/posts/neural_style_transfer/>Neural Style Transfer</a></li><li class=mb2><a href=/posts/mandelbrot/>Mandelbrot images</a></li><li class=mb2><a href=/posts/sudoko_solver/>Sudoku Solver</a></li></ul></div></aside></article></main><footer class="bg-black bottom-0 w-100 pa3" role=contentinfo><div class="flex justify-between"><a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href=https://scheuclu.github.io>&copy; Lukas Scheucher 2022</a><div><div class=ananke-socials><a href=https://github.com/scheuclu target=_blank class="github ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="GitHub link" rel=noopener aria-label="follow on GitHub——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 512 512" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M256 32C132.3 32 32 134.8 32 261.7c0 101.5 64.2 187.5 153.2 217.9 11.2 2.1 15.3-5 15.3-11.1.0-5.5-.2-19.9-.3-39.1-62.3 13.9-75.5-30.8-75.5-30.8-10.2-26.5-24.9-33.6-24.9-33.6-20.3-14.3 1.5-14 1.5-14 22.5 1.6 34.3 23.7 34.3 23.7 20 35.1 52.4 25 65.2 19.1 2-14.8 7.8-25 14.2-30.7-49.7-5.8-102-25.5-102-113.5.0-25.1 8.7-45.6 23-61.6-2.3-5.8-10-29.2 2.2-60.8.0.0 18.8-6.2 61.6 23.5 17.9-5.1 37-7.6 56.1-7.7 19 .1 38.2 2.6 56.1 7.7 42.8-29.7 61.5-23.5 61.5-23.5 12.2 31.6 4.5 55 2.2 60.8 14.3 16.1 23 36.6 23 61.6.0 88.2-52.4 107.6-102.3 113.3 8 7.1 15.2 21.1 15.2 42.5.0 30.7-.3 55.5-.3 63 0 6.1 4 13.3 15.4 11C415.9 449.1 480 363.1 480 261.7 480 134.8 379.7 32 256 32z"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href target=_blank class="linkedin ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="LinkedIn link" rel=noopener aria-label="follow on LinkedIn——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 65 65" viewBox="0 0 65 65" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M50.837 48.137V36.425c0-6.275-3.35-9.195-7.816-9.195-3.604.0-5.219 1.983-6.119 3.374V27.71h-6.79c.09 1.917.0 20.427.0 20.427h6.79V36.729c0-.609.044-1.219.224-1.655.49-1.22 1.607-2.483 3.482-2.483 2.458.0 3.44 1.873 3.44 4.618v10.929H50.837zM22.959 24.922c2.367.0 3.842-1.57 3.842-3.531-.044-2.003-1.475-3.528-3.797-3.528s-3.841 1.524-3.841 3.528c0 1.961 1.474 3.531 3.753 3.531H22.959zM34 64C17.432 64 4 50.568 4 34 4 17.431 17.432 4 34 4s30 13.431 30 30c0 16.568-13.432 30-30 30zM26.354 48.137V27.71h-6.789v20.427h6.789z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a><a href=https://www.youtube.com/channel/UC0So4gJ11qUZI_dzqVMOq8w target=_blank class="youtube ananke-social-link link-transition stackoverflow link dib z-999 pt3 pt0-l mr1" title="YouTube link" rel=noopener aria-label="follow on YouTube——Opens in a new window"><span class=icon><svg style="enable-background:new 0 0 67 67" viewBox="0 0 67 67" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M42.527 41.34c-.278.0-.478.078-.6.244-.121.156-.18.424-.18.796v.896h1.543V42.38c0-.372-.062-.64-.185-.796C42.989 41.418 42.792 41.34 42.527 41.34zM36.509 41.309c.234.0.417.076.544.23.123.155.185.383.185.682v4.584c0 .286-.053.487-.153.611-.1.127-.256.189-.47.189-.148.0-.287-.033-.421-.096-.135-.062-.274-.171-.415-.313v-5.531c.119-.122.239-.213.36-.271C36.26 41.335 36.383 41.309 36.509 41.309zm5.239 3.349v1.672c0 .468.057.792.17.974.118.181.313.269.592.269.289.0.491-.076.606-.229.114-.153.175-.489.175-1.013v-.405h1.795v.456c0 .911-.217 1.596-.657 2.059-.435.459-1.089.687-1.958.687-.781.0-1.398-.242-1.847-.731-.448-.486-.676-1.157-.676-2.014v-3.986c0-.768.249-1.398.742-1.882.493-.484 1.128-.727 1.911-.727.799.0 1.413.225 1.843.674.429.448.642 1.093.642 1.935v2.264H41.748zm-3.125 3.837c-.271.336-.669.501-1.187.501-.343.0-.646-.062-.912-.192-.267-.129-.519-.327-.746-.601v.681h-1.764V36.852h1.764v3.875c.237-.27.485-.478.748-.616.267-.143.534-.212.805-.212.554.0.975.189 1.265.565.294.379.438.933.438 1.66v4.926C39.034 47.678 38.897 48.159 38.623 48.495zM30.958 48.884v-.976c-.325.361-.658.636-1.009.822-.349.191-.686.282-1.014.282-.405.0-.705-.129-.913-.396-.201-.266-.305-.658-.305-1.189v-7.422h1.744v6.809c0 .211.037.362.107.457.077.095.196.141.358.141.128.0.292-.062.488-.188.197-.125.375-.283.542-.475v-6.744H32.7v8.878H30.958zM24.916 38.6v10.284h-1.968V38.6h-2.034v-1.748h6.036V38.6H24.916zm8.078-5.622c0-.001 12.08.018 13.514 1.45 1.439 1.435 1.455 8.514 1.455 8.555.0.0-.012 7.117-1.455 8.556C45.074 52.969 32.994 53 32.994 53s-12.079-.031-13.516-1.462c-1.438-1.435-1.441-8.502-1.441-8.556.0-.041.004-7.12 1.441-8.555 1.438-1.431 13.516-1.45 13.516-1.449zm9.526-3.723h-1.966v-1.08c-.358.397-.736.703-1.13.909-.392.208-.771.312-1.14.312-.458.0-.797-.146-1.027-.437-.229-.291-.345-.727-.345-1.311v-8.172h1.962v7.497c0 .231.045.399.127.502.08.104.216.156.399.156.143.0.327-.069.548-.206.22-.137.423-.312.605-.527v-7.422h1.966V29.255zM31.847 27.588c.139.147.339.219.6.219.266.0.476-.075.634-.223.157-.152.235-.358.235-.618v-5.327c0-.214-.08-.387-.241-.519-.16-.131-.37-.196-.628-.196-.241.0-.435.065-.586.196-.148.132-.225.305-.225.519v5.327C31.636 27.233 31.708 27.439 31.847 27.588zm-1.439-7.685c.528-.449 1.241-.674 2.132-.674.812.0 1.48.237 2.001.711.517.473.777 1.083.777 1.828v5.051c0 .836-.255 1.491-.762 1.968-.513.476-1.212.714-2.106.714-.858.0-1.547-.246-2.064-.736-.513-.492-.772-1.152-.772-1.983v-5.068C29.613 20.954 29.877 20.351 30.408 19.903zM24.262 16h-2.229l2.634 8.003v5.252h2.213v-5.5L29.454 16h-2.25l-1.366 5.298h-.139L24.262 16zM33 64C16.432 64 3 50.569 3 34S16.432 4 33 4s30 13.431 30 30S49.568 64 33 64z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span><span class=new-window><svg height="8" style="enable-background:new 0 0 1000 1000" viewBox="0 0 1e3 1e3" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M598 128h298v298h-86V274L392 692l-60-60 418-418H598v-86zM810 810V512h86v298c0 46-40 86-86 86H214c-48 0-86-40-86-86V214c0-46 38-86 86-86h298v86H214v596h596z" style="fill-rule:evenodd;clip-rule:evenodd"/></svg></span></a></div></div></div></footer><html><body></body></html></body></html>